{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RAG Evaluation Benchmark Schema",
  "description": "Schema for gold standard benchmark files used in RAG evaluation",
  "version": "2.0",
  "type": "object",
  "required": [
    "schema_version",
    "benchmark_version",
    "benchmark_type",
    "created_date",
    "client",
    "environment",
    "config",
    "metrics",
    "latency",
    "tokens",
    "cost",
    "breakdown_by_type",
    "breakdown_by_difficulty"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "description": "Schema version for compatibility",
      "example": "2.0"
    },
    "benchmark_version": {
      "type": "string",
      "description": "Benchmark version (MAJOR.MINOR)",
      "example": "1.3"
    },
    "benchmark_type": {
      "type": "string",
      "enum": ["local", "cloud"],
      "description": "Environment type"
    },
    "created_date": {
      "type": "string",
      "format": "date",
      "description": "Date benchmark was created",
      "example": "2025-12-18"
    },
    "client": {
      "type": "string",
      "description": "Client identifier",
      "example": "BFAI"
    },
    "source_run": {
      "type": "string",
      "description": "Run ID that created this benchmark",
      "example": "R001"
    },
    "source_file": {
      "type": "string",
      "description": "Source results file",
      "example": "results_p25_cloud.json"
    },
    "environment": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["local", "cloud"] },
        "endpoint": { "type": "string", "description": "Cloud Run URL (if cloud)" },
        "model": { "type": "string" },
        "reasoning_effort": { "type": "string", "enum": ["low", "medium", "high"] }
      }
    },
    "index": {
      "type": "object",
      "properties": {
        "job_id": { "type": "string" },
        "embedding_model": { "type": "string" },
        "embedding_dimension": { "type": "integer" }
      }
    },
    "corpus": {
      "type": "object",
      "properties": {
        "file": { "type": "string" },
        "question_count": { "type": "integer" },
        "distribution": {
          "type": "object",
          "properties": {
            "single_hop": { "type": "integer" },
            "multi_hop": { "type": "integer" },
            "easy": { "type": "integer" },
            "medium": { "type": "integer" },
            "hard": { "type": "integer" }
          }
        }
      }
    },
    "config": {
      "type": "object",
      "properties": {
        "model": { "type": "string" },
        "reasoning_effort": { "type": "string" },
        "temperature": { "type": "number" },
        "recall_top_k": { "type": "integer" },
        "precision_top_n": { "type": "integer" },
        "hybrid_search": { "type": "boolean" },
        "reranking": { "type": "boolean" },
        "rrf_alpha": { "type": "number" }
      }
    },
    "metrics": {
      "type": "object",
      "properties": {
        "pass_rate": { "type": "number", "minimum": 0, "maximum": 1 },
        "partial_rate": { "type": "number", "minimum": 0, "maximum": 1 },
        "fail_rate": { "type": "number", "minimum": 0, "maximum": 1 },
        "acceptable_rate": { "type": "number", "minimum": 0, "maximum": 1 },
        "recall_at_100": { "type": "number", "minimum": 0, "maximum": 1 },
        "mrr": { "type": "number", "minimum": 0, "maximum": 1 },
        "overall_score_avg": { "type": "number", "minimum": 1, "maximum": 5 },
        "scores": {
          "type": "object",
          "properties": {
            "correctness_avg": { "type": "number" },
            "completeness_avg": { "type": "number" },
            "faithfulness_avg": { "type": "number" },
            "relevance_avg": { "type": "number" },
            "clarity_avg": { "type": "number" }
          }
        }
      }
    },
    "latency": {
      "type": "object",
      "properties": {
        "total_avg_s": { "type": "number", "description": "Total latency including judge" },
        "client_experience_s": { "type": "number", "description": "Latency excluding judge (what user sees)" },
        "judge_avg_s": { "type": "number" },
        "by_phase": {
          "type": "object",
          "description": "Per-phase latency breakdown"
        }
      }
    },
    "tokens": {
      "type": "object",
      "properties": {
        "prompt_total": { "type": "integer" },
        "completion_total": { "type": "integer" },
        "thinking_total": { "type": "integer" },
        "cached_total": { "type": "integer" },
        "total": { "type": "integer" },
        "per_question": {
          "type": "object",
          "properties": {
            "prompt_avg": { "type": "integer" },
            "completion_avg": { "type": "integer" },
            "thinking_avg": { "type": "integer" }
          }
        }
      }
    },
    "cost": {
      "type": "object",
      "properties": {
        "input_usd": { "type": "number" },
        "output_usd": { "type": "number" },
        "thinking_usd": { "type": "number" },
        "total_usd": { "type": "number" },
        "per_question_usd": { "type": "number" },
        "per_1k_questions_usd": { "type": "number" },
        "pricing": { "type": "string", "description": "Pricing model used" }
      }
    },
    "breakdown_by_type": {
      "type": "object",
      "description": "Pass/partial/fail by question type (single_hop, multi_hop)",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "total": { "type": "integer" },
          "pass": { "type": "integer" },
          "partial": { "type": "integer" },
          "fail": { "type": "integer" },
          "pass_rate": { "type": "number" }
        }
      }
    },
    "breakdown_by_difficulty": {
      "type": "object",
      "description": "Pass/partial/fail by difficulty (easy, medium, hard)",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "total": { "type": "integer" },
          "pass": { "type": "integer" },
          "partial": { "type": "integer" },
          "fail": { "type": "integer" },
          "pass_rate": { "type": "number" }
        }
      }
    },
    "failures": {
      "type": "array",
      "description": "List of failed questions",
      "items": {
        "type": "object",
        "properties": {
          "question_id": { "type": "string" },
          "question_type": { "type": "string" },
          "difficulty": { "type": "string" },
          "overall_score": { "type": "number" }
        }
      }
    },
    "execution": {
      "type": "object",
      "properties": {
        "run_timestamp": { "type": "string", "format": "date-time" },
        "run_duration_seconds": { "type": "number" },
        "questions_per_second": { "type": "number" },
        "workers": { "type": "integer" }
      }
    },
    "notes": {
      "type": "string",
      "description": "Human-readable notes about this benchmark"
    }
  }
}
